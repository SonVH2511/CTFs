data = [0x22, 0x70, 0x6A, 0x0C, 0x58, 0x3F, 0x05, 0x08, 0x74, 0x3A,
        0x53, 0x0C, 0x79, 0x55, 0x77, 0x51, 0x4F, 0x4A, 0x2A, 0x37,
        0x45, 0x70, 0x5C, 0x52, 0x45, 0x7E, 0x71, 0x61, 0x51, 0x56,
        0x4F, 0x04, 0x5E, 0x59, 0x69, 0x10, 0x26, 0x50, 0x28, 0x68,
        0x06, 0x3B, 0x39, 0x30, 0x29, 0x01, 0x69, 0x71, 0x33, 0x41,
        0x47, 0x70, 0x2A, 0x7E, 0x14, 0x72, 0x1B, 0x5B, 0x42, 0x11,
        0x7C, 0x51, 0x2B, 0x78, 0x23, 0x68, 0x0C, 0x76, 0x27, 0x05,
        0x00]

# data = [4, 33, 83, 52, 39, 87, 72, 116, 44, 19, 39, 104, 59, 22, 48, 106, 28, 112, 48, 82, 83, 8, 12, 92, 119, 113, 33, 90, 92, 95, 102, 123, 119, 63,
#         112, 45, 20, 107, 113, 54, 4, 79, 102, 73, 4, 24, 13, 6, 97, 84, 117, 125, 117, 3, 31, 122, 49, 10, 93, 125, 88, 16, 111, 24, 1, 40, 126, 14, 66, 45, 76]

# input_key = [1, 2, 3, 4, 5]

input_key = [0x45, 0x32, 0x55, 0x35, 0x14, 0x0F, 0x5D, 0x63, 0x26, 0x76,
             0x74, 0x06, 0x02, 0x31, 0x05, 0x34, 0x51, 0x77, 0x5C, 0x2C,
             0x3F, 0x2B, 0x3E, 0x36, 0x28, 0x07, 0x50, 0x7D, 0x40, 0x58,
             0x24, 0x15, 0x65, 0x79, 0x6F, 0x5A, 0x3A, 0x59, 0x3B, 0x04,
             0x5C, 0x4C, 0x2F, 0x3D, 0x26, 0x11, 0x38, 0x2A, 0x17, 0x42,
             0x30, 0x4E, 0x1B, 0x05, 0x06, 0x49]

Map = [0]*128

# print(Map)
# print(len(Map))
# print(len(key))

for i in range(128):
    Map[i] = i

v4 = 0
for j in range(128):
    v4 = (input_key[j % len(input_key)] + v4 + Map[j]) % 128
    # swap( & Map[j], & Map[v4])
    Map[j], Map[v4] = Map[v4], Map[j]

encypted_data = [0]*len(data)
cnt = 0
v6 = 0
for i in range(len(data)):
    cnt = (cnt+1) % 128
    v6 = (v6+Map[cnt]) % 128
    Map[cnt], Map[v6] = Map[v6], Map[cnt]
    encypted_data[i] = (Map[(Map[v6] + Map[cnt]) % 128] ^ data[i]) & 0xff


# for i in encypted_data:
#     print(hex(i), end=" ")
print(encypted_data)
for i in encypted_data:
    print(chr(i), end="")

# KMA{haycuvotuvalacquanlenemoichilakhongyeuthuongthoisaonuocmatphairoi}
